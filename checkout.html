<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LITESTORE ‚Äî P≈Çatno≈õƒá</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #111;
            color: #fff;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 24px;
        }

        /* Mountain background */
        .bg-mountains {
            position: fixed;
            inset: 0;
            z-index: 0;
            pointer-events: none;
            overflow: hidden;
        }
        .bg-mountains svg {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 70%;
            opacity: 0.07;
        }

        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background:
                radial-gradient(ellipse 80% 60% at 50% 0%, rgba(255,255,255,0.03) 0%, transparent 70%),
                radial-gradient(ellipse 40% 40% at 80% 80%, rgba(255,255,255,0.02) 0%, transparent 60%);
            pointer-events: none;
            z-index: 0;
        }

        /* Back link */
        .back-link {
            position: fixed;
            top: 28px; left: 28px;
            display: flex; align-items: center; gap: 8px;
            font-size: 11px; font-weight: 700; letter-spacing: 2px;
            color: #444; text-decoration: none; text-transform: uppercase;
            transition: color 0.2s; z-index: 10;
        }
        .back-link:hover { color: #fff; }
        .back-link svg { width: 16px; height: 16px; fill: currentColor; }

        /* Layout */
        .checkout-wrap {
            position: relative;
            z-index: 1;
            width: 100%;
            max-width: 860px;
            display: grid;
            grid-template-columns: 1fr 1.4fr;
            gap: 24px;
            align-items: start;
        }

        /* Card base */
        .card {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 24px;
            padding: 32px;
            position: relative;
            overflow: hidden;
        }
        .card::before {
            content: '';
            position: absolute;
            top: 0; left: 12%; right: 12%;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.15), transparent);
        }

        /* Order summary */
        .order-label {
            font-size: 9px; letter-spacing: 3px; color: #555;
            text-transform: uppercase; font-weight: 700; margin-bottom: 20px;
        }
        .order-product {
            display: flex; align-items: center; gap: 16px; margin-bottom: 28px;
        }
        .order-icon {
            width: 56px; height: 56px;
            background: #fff; border-radius: 14px;
            display: flex; align-items: center; justify-content: center;
            flex-shrink: 0;
        }
        .order-icon svg { width: 28px; height: 28px; fill: #000; }
        .order-icon.dark { background: rgba(255,255,255,0.1); }
        .order-icon.dark svg { fill: #fff; }
        .order-type { font-size: 10px; color: #555; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 6px; }
        .order-name { font-size: 22px; font-weight: 900; letter-spacing: -0.5px; }
        .divider-line {
            height: 1px; background: rgba(255,255,255,0.06); margin: 20px 0;
        }
        .price-row {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 10px;
        }
        .price-row-label { font-size: 12px; color: #555; }
        .price-row-val { font-size: 12px; color: #888; }
        .price-total {
            display: flex; justify-content: space-between; align-items: center;
            margin-top: 16px;
        }
        .price-total-label { font-size: 13px; font-weight: 700; letter-spacing: 1px; }
        .price-total-val { font-size: 26px; font-weight: 900; letter-spacing: -0.5px; }

        .trust-badges {
            display: flex; flex-direction: column; gap: 10px; margin-top: 24px;
        }
        .trust-badge {
            display: flex; align-items: center; gap: 10px;
            font-size: 11px; color: #444;
        }
        .trust-badge svg { width: 14px; height: 14px; fill: #444; flex-shrink: 0; }

        /* Payment form */
        .form-label-top {
            font-size: 9px; letter-spacing: 3px; color: #555;
            text-transform: uppercase; font-weight: 700; margin-bottom: 20px;
        }

        /* Steps */
        .steps {
            display: flex; gap: 0; margin-bottom: 28px;
            border: 1px solid rgba(255,255,255,0.07);
            border-radius: 14px; overflow: hidden;
        }
        .step {
            flex: 1; padding: 12px 8px; text-align: center;
            font-size: 9px; font-weight: 700; letter-spacing: 1.5px;
            text-transform: uppercase; color: #444;
            background: transparent;
            border-right: 1px solid rgba(255,255,255,0.07);
            display: flex; flex-direction: column; align-items: center; gap: 4px;
        }
        .step:last-child { border-right: none; }
        .step.active { color: #fff; background: rgba(255,255,255,0.06); }
        .step.done { color: #22c55e; }
        .step-num {
            width: 20px; height: 20px;
            border-radius: 50%;
            background: rgba(255,255,255,0.08);
            font-size: 10px; font-weight: 800;
            display: flex; align-items: center; justify-content: center;
        }
        .step.active .step-num { background: #fff; color: #000; }
        .step.done .step-num { background: #22c55e; color: #000; }

        /* Pages */
        .checkout-page { display: none; }
        .checkout-page.active { display: block; }

        /* Method select */
        .method-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 24px; }
        .method-card {
            border: 2px solid rgba(255,255,255,0.08);
            border-radius: 16px; padding: 20px 16px;
            cursor: pointer; transition: all 0.2s;
            background: rgba(255,255,255,0.02);
            text-align: center;
        }
        .method-card:hover { border-color: rgba(255,255,255,0.2); background: rgba(255,255,255,0.05); }
        .method-card.selected { border-color: #fff; background: rgba(255,255,255,0.07); }
        .method-icon { font-size: 28px; margin-bottom: 10px; }
        .method-icon-svg {
            width: 48px; height: 48px;
            background: rgba(255,255,255,0.07);
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            margin: 0 auto 12px;
        }
        .method-icon-svg svg { width: 26px; height: 26px; fill: #fff; }
        .method-name { font-size: 13px; font-weight: 800; margin-bottom: 4px; }
        .method-sub { font-size: 10px; color: #555; letter-spacing: 1px; }

        /* BLIK details */
        .blik-box {
            background: rgba(255,255,255,0.04);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 16px; padding: 24px;
            margin-bottom: 20px;
        }
        .blik-title {
            font-size: 11px; font-weight: 700; letter-spacing: 2px;
            text-transform: uppercase; color: #888; margin-bottom: 16px;
        }
        .blik-number {
            font-size: 32px; font-weight: 900; letter-spacing: 4px;
            margin-bottom: 8px; font-variant-numeric: tabular-nums;
        }
        .blik-amount {
            font-size: 13px; color: #555; margin-bottom: 20px;
        }
        .blik-steps { display: flex; flex-direction: column; gap: 10px; }
        .blik-step {
            display: flex; align-items: flex-start; gap: 12px;
            font-size: 13px; color: #888; line-height: 1.4;
        }
        .blik-step-num {
            width: 22px; height: 22px; border-radius: 50%;
            background: rgba(255,255,255,0.08);
            font-size: 10px; font-weight: 800; color: #fff;
            display: flex; align-items: center; justify-content: center;
            flex-shrink: 0; margin-top: 1px;
        }

        /* Crypto details */
        .crypto-box {
            background: rgba(255,255,255,0.04);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 16px; padding: 24px;
            margin-bottom: 20px;
        }
        .crypto-title {
            font-size: 11px; font-weight: 700; letter-spacing: 2px;
            text-transform: uppercase; color: #888; margin-bottom: 16px;
        }
        .crypto-network {
            display: inline-flex; align-items: center; gap: 6px;
            background: rgba(168,85,247,0.1); border: 1px solid rgba(168,85,247,0.2);
            color: #a855f7; font-size: 10px; font-weight: 700; letter-spacing: 1.5px;
            padding: 5px 12px; border-radius: 8px; margin-bottom: 14px;
            text-transform: uppercase;
        }
        .crypto-address-label { font-size: 10px; color: #555; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 8px; }
        .crypto-address {
            font-size: 11px; font-family: monospace;
            background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px; padding: 12px 14px;
            word-break: break-all; color: #ccc; line-height: 1.6;
            display: flex; align-items: center; justify-content: space-between; gap: 10px;
            margin-bottom: 14px;
        }
        .copy-btn {
            background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px; padding: 6px 10px; color: #888;
            font-size: 10px; font-weight: 700; letter-spacing: 1px;
            cursor: pointer; flex-shrink: 0; transition: all 0.2s;
            text-transform: uppercase;
        }
        .copy-btn:hover { background: rgba(255,255,255,0.15); color: #fff; }
        .crypto-amount-box {
            display: flex; justify-content: space-between; align-items: center;
            background: rgba(255,255,255,0.04); border-radius: 10px; padding: 12px 14px;
            margin-bottom: 14px;
        }
        .crypto-amount-label { font-size: 10px; color: #555; text-transform: uppercase; letter-spacing: 1.5px; }
        .crypto-amount-val { font-size: 16px; font-weight: 900; }
        .crypto-note { font-size: 11px; color: #444; line-height: 1.6; }

        /* Roblox form */
        .field { margin-bottom: 20px; }
        .field label {
            display: block; font-size: 10px; font-weight: 700;
            letter-spacing: 2px; color: #555; text-transform: uppercase; margin-bottom: 10px;
        }
        .field input {
            width: 100%; padding: 15px 18px;
            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.08);
            border-radius: 14px; color: #fff; font-size: 14px; font-family: inherit;
            outline: none; transition: all 0.25s;
        }
        .field input:focus {
            border-color: rgba(255,255,255,0.2); background: rgba(255,255,255,0.08);
            box-shadow: 0 0 0 3px rgba(255,255,255,0.04);
        }
        .field input::placeholder { color: #333; }
        .field-hint { font-size: 11px; color: #444; margin-top: 8px; line-height: 1.5; }

        /* Confirm checkbox */
        .confirm-row {
            display: flex; align-items: flex-start; gap: 12px;
            margin-bottom: 24px; cursor: pointer;
        }
        .confirm-row input[type=checkbox] { margin-top: 2px; accent-color: #fff; flex-shrink: 0; }
        .confirm-row span { font-size: 12px; color: #555; line-height: 1.6; }

        /* Buttons */
        .btn-main {
            width: 100%; padding: 17px;
            background: #fff; color: #000; border: none;
            border-radius: 14px; font-size: 11px; font-weight: 800;
            letter-spacing: 2.5px; text-transform: uppercase;
            cursor: pointer; transition: all 0.2s; font-family: inherit;
        }
        .btn-main:hover { background: #f0f0f0; transform: translateY(-2px); box-shadow: 0 6px 20px rgba(255,255,255,0.12); }
        .btn-main:disabled { opacity: 0.4; cursor: not-allowed; transform: none; box-shadow: none; }
        .btn-back-step {
            width: 100%; padding: 13px;
            background: transparent; color: #555; border: 1px solid rgba(255,255,255,0.08);
            border-radius: 14px; font-size: 11px; font-weight: 700;
            letter-spacing: 1.5px; text-transform: uppercase;
            cursor: pointer; transition: all 0.2s; font-family: inherit;
            margin-top: 10px;
        }
        .btn-back-step:hover { color: #fff; border-color: rgba(255,255,255,0.2); }

        /* Success */
        .success-icon {
            width: 72px; height: 72px;
            background: rgba(34,197,94,0.1); border: 1px solid rgba(34,197,94,0.2);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            margin: 0 auto 24px;
        }
        .success-icon svg { width: 36px; height: 36px; fill: #22c55e; }
        .success-title { font-size: 24px; font-weight: 900; text-align: center; margin-bottom: 10px; }
        .success-sub { font-size: 14px; color: #666; text-align: center; line-height: 1.6; margin-bottom: 28px; }
        .success-info {
            background: rgba(34,197,94,0.06); border: 1px solid rgba(34,197,94,0.15);
            border-radius: 14px; padding: 20px; margin-bottom: 20px;
        }
        .success-info-row { display: flex; justify-content: space-between; font-size: 13px; margin-bottom: 8px; }
        .success-info-row:last-child { margin-bottom: 0; }
        .success-info-label { color: #555; }
        .success-info-val { font-weight: 700; }

        /* Error msg */
        #error-msg { font-size: 12px; color: #ef4444; margin-bottom: 12px; min-height: 16px; }

        /* Responsive */
        @media (max-width: 700px) {
            .checkout-wrap { grid-template-columns: 1fr; }
            .method-grid { grid-template-columns: 1fr 1fr; }
            .back-link { top: 16px; left: 16px; }
            body { padding: 70px 16px 24px; align-items: flex-start; }
        }
    </style>
</head>
<body>

<a href="index.html" class="back-link">
    <svg viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
    Wr√≥ƒá
</a>

<!-- Mountain background -->
<div class="bg-mountains">
    <svg viewBox="0 0 1440 400" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
        <path fill="#fff" d="M0,400 L0,280 L120,180 L200,240 L320,100 L420,200 L520,120 L600,180 L720,40 L820,160 L920,80 L1020,180 L1120,100 L1220,200 L1320,130 L1440,220 L1440,400 Z"/>
        <path fill="#fff" opacity="0.5" d="M0,400 L0,320 L100,260 L180,300 L280,220 L380,280 L480,200 L560,260 L680,180 L760,240 L860,160 L960,240 L1060,180 L1160,260 L1260,200 L1360,270 L1440,240 L1440,400 Z"/>
    </svg>
</div>

<div class="checkout-wrap">

    <!-- LEFT: Order summary -->
    <div class="card" id="order-summary">
        <div class="order-label">Twoje zam√≥wienie</div>
        <div class="order-product">
            <div class="order-icon dark" id="summary-icon">
                <svg viewBox="0 0 24 24"><path d="M6 2l-4 4 4 4 4-4-4-4zm6.5 7C11.12 9 10 10.12 10 11.5s1.12 2.5 2.5 2.5 2.5-1.12 2.5-2.5S13.88 9 12.5 9zM17 14c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"/></svg>
            </div>
            <div>
                <div class="order-type" id="summary-type">PAKIET ROBUX</div>
                <div class="order-name" id="summary-name">1 000 ROBUX</div>
            </div>
        </div>
        <div class="divider-line"></div>
        <div class="price-row">
            <span class="price-row-label">Produkt</span>
            <span class="price-row-val" id="summary-price-sub">33,00 z≈Ç</span>
        </div>
        <div class="price-row">
            <span class="price-row-label">Dostawa</span>
            <span class="price-row-val" style="color:#22c55e;">GRATIS</span>
        </div>
        <div class="divider-line"></div>
        <div class="price-total">
            <span class="price-total-label">RAZEM</span>
            <span class="price-total-val" id="summary-price-total">33,00 z≈Ç</span>
        </div>
        <div class="trust-badges">
            <div class="trust-badge">
                <svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/></svg>
                Bezpieczna transakcja
            </div>
            <div class="trust-badge">
                <svg viewBox="0 0 24 24"><path d="M7 2v11h3v9l7-12h-4l4-8z"/></svg>
                Dostawa do 6 godzin
            </div>
            <div class="trust-badge">
                <svg viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 9h12v2H6V9zm8 5H6v-2h8v2zm4-6H6V6h12v2z"/></svg>
                Wsparcie 24/7
            </div>
        </div>
    </div>

    <!-- RIGHT: Payment form -->
    <div class="card">
        <div class="form-label-top">P≈Çatno≈õƒá</div>

        <!-- Steps indicator ‚Äî 4 kroki -->
        <div class="steps">
            <div class="step active" id="step1"><div class="step-num">1</div>Metoda</div>
            <div class="step" id="step2"><div class="step-num">2</div>P≈Çatno≈õƒá</div>
            <div class="step" id="step3"><div class="step-num">3</div>Gamepass</div>
            <div class="step" id="step4"><div class="step-num">4</div>Dane</div>
        </div>

        <!-- PAGE 1: Wyb√≥r metody -->
        <div class="checkout-page active" id="page-method">
            <div class="method-grid">
                <div class="method-card" id="method-blik" onclick="selectMethod('blik')">
                    <div class="method-icon-svg">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 1.01L7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14zm-4.2-5.78v1.75l3.2-2.99L12.8 9v1.7c-3.11.43-4.35 2.56-4.8 4.7 1.11-1.47 2.88-2.44 4.8-2.18z"/></svg>
                    </div>
                    <div class="method-name">BLIK</div>
                    <div class="method-sub">Przelew na numer</div>
                </div>
                <div class="method-card" id="method-ltc" onclick="selectMethod('ltc')">
                    <div class="method-icon-svg">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16z"/></svg>
                    </div>
                    <div class="method-name">Litecoin</div>
                    <div class="method-sub">Krypto LTC</div>
                </div>
            </div>
            <p id="error-msg"></p>
            <button class="btn-main" onclick="goToPayment()">DALEJ ‚Üí</button>
        </div>

        <!-- PAGE 2a: BLIK -->
        <div class="checkout-page" id="page-blik">
            <div class="blik-box">
                <div class="blik-title">Przelew BLIK na numer</div>
                <div class="blik-number">690 178 013</div>
                <div class="blik-amount">Kwota: <strong id="blik-amount-val">33,00 z≈Ç</strong></div>
                <div class="blik-steps">
                    <div class="blik-step">
                        <div class="blik-step-num">1</div>
                        <span>Otw√≥rz swojƒÖ aplikacjƒô bankowƒÖ i wybierz <strong>BLIK ‚Üí Przelew na numer telefonu</strong></span>
                    </div>
                    <div class="blik-step">
                        <div class="blik-step-num">2</div>
                        <span>Wpisz numer <strong>690 178 013</strong> i kwotƒô <strong id="blik-amount-val2">33,00 z≈Ç</strong></span>
                    </div>
                    <div class="blik-step">
                        <div class="blik-step-num">3</div>
                        <span>W tytule przelewu wpisz sw√≥j <strong>nick w Roblox</strong></span>
                    </div>
                    <div class="blik-step">
                        <div class="blik-step-num">4</div>
                        <span>Po wys≈Çaniu kliknij "Zap≈Çaci≈Çem" poni≈ºej</span>
                    </div>
                </div>
            </div>
            <button class="btn-main" onclick="goToGamepass()">ZAP≈ÅACI≈ÅEM ‚úì</button>
            <button class="btn-back-step" onclick="goBack(1)">‚Üê Zmie≈Ñ metodƒô</button>
        </div>

        <!-- PAGE 2b: LTC -->
        <div class="checkout-page" id="page-ltc">
            <div class="crypto-box">
                <div class="crypto-title">P≈Çatno≈õƒá Litecoin (LTC)</div>
                <div class="crypto-network">‚ö° Sieƒá Litecoin (LTC)</div>
                <div class="crypto-address-label">Adres portfela</div>
                <div class="crypto-address">
                    <span style="word-break:break-all;">LSLVPzskezU8pvh4QPvQhf9G4UBzio4qSP</span>
                    <button class="copy-btn" onclick="copyAddress()">KOPIUJ</button>
                </div>
                <div class="crypto-amount-box">
                    <span class="crypto-amount-label">Do zap≈Çaty (LTC)</span>
                    <span class="crypto-amount-val" id="ltc-amount-ltc">
                        <span style="font-size:12px;color:#555;">pobieranie kursu...</span>
                    </span>
                </div>
                <div class="crypto-amount-box" style="margin-top:-8px;">
                    <span class="crypto-amount-label">R√≥wnowarto≈õƒá PLN</span>
                    <span style="font-size:14px;color:#888;" id="ltc-amount-pln-display">‚Äî</span>
                </div>
                <div style="
                    background: rgba(255,255,255,0.05);
                    border: 1px solid rgba(255,255,255,0.12);
                    border-radius: 12px;
                    padding: 16px 18px;
                    font-size: 14px;
                    font-weight: 700;
                    color: #fff;
                    line-height: 1.6;
                    margin-top: 4px;
                ">
                    ‚ö†Ô∏è Wy≈õlij <strong>dok≈ÇadnƒÖ kwotƒô</strong> w LTC odpowiadajƒÖcƒÖ cenie w z≈Çotych.<br>
                    <span style="font-size:12px;font-weight:500;color:#888;">Po wys≈Çaniu kliknij "Weryfikuj p≈Çatno≈õƒá" ‚Äî sprawdzimy blockchain automatycznie.</span>
                </div>
            </div>

            <!-- Weryfikacja status -->
            <div id="ltc-verify-status" style="display:none;margin-bottom:16px;padding:14px 18px;border-radius:12px;font-size:13px;font-weight:600;"></div>

            <button class="btn-main" id="ltc-verify-btn" onclick="verifyLTC()">WERYFIKUJ P≈ÅATNO≈öƒÜ</button>
            <button class="btn-back-step" onclick="goBack(1)">‚Üê Zmie≈Ñ metodƒô</button>
        </div>

        <!-- PAGE 3: Gamepass instrukcja -->
        <div class="checkout-page" id="page-gamepass">
            <div style="margin-bottom:20px;">
                <div style="font-size:10px;letter-spacing:2px;color:#555;text-transform:uppercase;font-weight:700;margin-bottom:6px;">KROK 3 Z 4</div>
                <div style="font-size:18px;font-weight:800;margin-bottom:4px;">Utw√≥rz Gamepass</div>
                <div style="font-size:13px;color:#666;line-height:1.5;">Musisz stworzyƒá Gamepass w Roblox na dok≈ÇadnƒÖ kwotƒô <strong id="gamepass-price" style="color:#fff;">33 ROBUX</strong> ‚Äî to jedyna metoda dostarczenia waluty.</div>
            </div>

            <!-- Video instrukcja -->
            <div style="
                background: rgba(255,255,255,0.03);
                border: 1px solid rgba(255,255,255,0.08);
                border-radius: 16px;
                overflow: hidden;
                margin-bottom: 16px;
            ">
                <div style="
                    display: flex; align-items: center; gap: 12px;
                    padding: 14px 18px;
                    border-bottom: 1px solid rgba(255,255,255,0.06);
                ">
                    <div style="
                        width: 32px; height: 32px;
                        background: rgba(239,68,68,0.15);
                        border-radius: 8px;
                        display: flex; align-items: center; justify-content: center;
                        flex-shrink: 0;
                    ">
                        <svg viewBox="0 0 24 24" style="width:16px;height:16px;fill:#ef4444;"><path d="M21.582,6.186c-0.23-0.86-0.908-1.538-1.768-1.768C18.254,4,12,4,12,4S5.746,4,4.186,4.418 c-0.86,0.23-1.538,0.908-1.768,1.768C2,7.746,2,12,2,12s0,4.254,0.418,5.814c0.23,0.86,0.908,1.538,1.768,1.768 C5.746,20,12,20,12,20s6.254,0,7.814-0.418c0.861-0.23,1.538-0.908,1.768-1.768C22,16.254,22,12,22,12S22,7.746,21.582,6.186z M10,15.464V8.536L16,12L10,15.464z"/></svg>
                    </div>
                    <div>
                        <div style="font-size:12px;font-weight:700;">Instrukcja video</div>
                        <div style="font-size:10px;color:#555;">Jak stworzyƒá Gamepass krok po kroku</div>
                    </div>
                </div>
                <div style="position:relative;padding-bottom:56.25%;height:0;overflow:hidden;">
                    <iframe
                        src=""
                        id="tutorial-video"
                        style="position:absolute;top:0;left:0;width:100%;height:100%;border:none;"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen>
                    </iframe>
                    <div id="video-placeholder" style="
                        position:absolute;inset:0;
                        display:flex;flex-direction:column;align-items:center;justify-content:center;
                        background:rgba(0,0,0,0.3);
                        color:#444;font-size:13px;gap:12px;
                    ">
                        <svg viewBox="0 0 24 24" style="width:40px;height:40px;fill:#333;"><path d="M21.582,6.186c-0.23-0.86-0.908-1.538-1.768-1.768C18.254,4,12,4,12,4S5.746,4,4.186,4.418 c-0.86,0.23-1.538,0.908-1.768,1.768C2,7.746,2,12,2,12s0,4.254,0.418,5.814c0.23,0.86,0.908,1.538,1.768,1.768 C5.746,20,12,20,12,20s6.254,0,7.814-0.418c0.861-0.23,1.538-0.908,1.768-1.768C22,16.254,22,12,22,12S22,7.746,21.582,6.186z M10,15.464V8.536L16,12L10,15.464z"/></svg>
                        Video instrukcja wkr√≥tce
                    </div>
                </div>
            </div>

            <div class="field">
                <label>Link do Twojego Gamepassu</label>
                <input type="url" id="gamepass-link" placeholder="https://www.roblox.com/game-pass/123456/nazwa">
                <div class="field-hint">Stw√≥rz Gamepass ‚Üí skopiuj link i wklej tutaj</div>
            </div>
            <p id="error-gamepass" style="font-size:12px;color:#ef4444;margin-bottom:12px;min-height:16px;"></p>
            <button class="btn-main" onclick="goToRobloxForm()">DALEJ ‚Üí</button>
            <button class="btn-back-step" onclick="goBack(2)">‚Üê Wr√≥ƒá do p≈Çatno≈õci</button>
        </div>

        <!-- PAGE 4: Dane klienta -->
        <div class="checkout-page" id="page-roblox">
            <div class="field">
                <label>Nick w Roblox</label>
                <input type="text" id="roblox-nick" placeholder="Tw√≥jNick123">
            </div>
            <div class="field">
                <label>E-mail kontaktowy (opcjonalnie)</label>
                <input type="email" id="contact-email" placeholder="twoj@email.com">
                <div class="field-hint">Prze≈õlemy potwierdzenie gdy dostarczymy Robux</div>
            </div>
            <label class="confirm-row">
                <input type="checkbox" id="confirm-check">
                <span>Potwierdzam ≈ºe dokona≈Çem/am p≈Çatno≈õci i podane dane sƒÖ prawid≈Çowe</span>
            </label>
            <p id="error-msg2"></p>
            <button class="btn-main" onclick="submitOrder()">WY≈öLIJ ZAM√ìWIENIE</button>
            <button class="btn-back-step" onclick="goBack(3)">‚Üê Wr√≥ƒá</button>
        </div>

        <!-- PAGE 4: Sukces -->
        <div class="checkout-page" id="page-success">
            <div class="success-icon">
                <svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
            </div>
            <div class="success-title">Zam√≥wienie przyjƒôte!</div>
            <div class="success-sub">Dostarczymy Robux na Tw√≥j profil w ciƒÖgu <strong style="color:#fff;">do 6 godzin</strong>. Dostaniesz zaproszenie do grupy Roblox.</div>
            <div class="success-info">
                <div class="success-info-row">
                    <span class="success-info-label">Produkt</span>
                    <span class="success-info-val" id="success-product">1 000 ROBUX</span>
                </div>
                <div class="success-info-row">
                    <span class="success-info-label">Metoda p≈Çatno≈õci</span>
                    <span class="success-info-val" id="success-method">BLIK</span>
                </div>
                <div class="success-info-row">
                    <span class="success-info-label">Nick Roblox</span>
                    <span class="success-info-val" id="success-nick">‚Äî</span>
                </div>
                <div class="success-info-row">
                    <span class="success-info-label">Status</span>
                    <span class="success-info-val" style="color:#f97316;">‚è≥ Oczekuje na weryfikacjƒô</span>
                </div>
            </div>
            <a href="index.html" class="btn-main" style="display:flex;align-items:center;justify-content:center;text-decoration:none;">WR√ìƒÜ DO SKLEPU</a>
        </div>

    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getFirestore, addDoc, getDoc, setDoc, collection, doc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyDD3Z98au_WMwaawKi3lFJsycC0GCdW0jQ",
        authDomain: "lajciorstore.firebaseapp.com",
        projectId: "lajciorstore",
        storageBucket: "lajciorstore.firebasestorage.app",
        messagingSenderId: "7091718515313",
        appId: "1:7091718515313:web:87fdad9a266aa88edd320e"
    };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Sprawd≈∫ czy hash tx ju≈º by≈Ç u≈ºyty
    window._checkTxHash = async (txHash) => {
        const snap = await getDoc(doc(db, 'used_transactions', txHash));
        return snap.exists(); // true = ju≈º u≈ºyty
    };

    // Zarejestruj hash tx jako u≈ºyty
    window._markTxHash = async (txHash) => {
        await setDoc(doc(db, 'used_transactions', txHash), {
            usedAt: serverTimestamp()
        });
    };

    // Zapisz zam√≥wienie
    window._submitOrderFirebase = async (productName, productType, productPrice, productGame, selectedMethod, link, nick, email, txHash) => {
        await addDoc(collection(db, 'orders'), {
            title: productName,
            type: productType,
            game: productGame,
            price: parseFloat(productPrice.replace(' z≈Ç','').replace(',','.')),
            paymentMethod: selectedMethod === 'blik' ? 'BLIK' : 'Litecoin (LTC)',
            gamepassLink: link,
            clientNick: nick,
            clientEmail: email || null,
            ltcTxHash: txHash || null,
            status: 'pending',
            createdAt: serverTimestamp()
        });
    };
</script>

<script>
    // ‚îÄ‚îÄ State ‚îÄ‚îÄ
    var selectedMethod = null;
    var expectedLTC    = null;
    var verifiedTxHash = null;
    var LTC_ADDRESS    = 'LSLVPzskezU8pvh4QPvQhf9G4UBzio4qSP';

    // ‚îÄ‚îÄ URL params ‚îÄ‚îÄ
    var params = new URLSearchParams(window.location.search);
    var productName  = params.get('product') || '1 000 ROBUX';
    var productType  = params.get('type')    || 'PAKIET ROBUX';
    var productPrice = params.get('price')   || '33,00 z≈Ç';
    var productGame  = params.get('game')    || 'robux';
    var productRobux = params.get('robux') ? parseInt(params.get('robux')) : null;

    // ‚îÄ‚îÄ Fill summary ‚îÄ‚îÄ
    document.getElementById('summary-name').textContent         = productName;
    document.getElementById('summary-type').textContent         = productType;
    document.getElementById('summary-price-sub').textContent    = productPrice;
    document.getElementById('summary-price-total').textContent  = productPrice;
    document.getElementById('blik-amount-val').textContent      = productPrice;
    document.getElementById('blik-amount-val2').textContent     = productPrice;
    document.getElementById('success-product').textContent      = productName;
    document.title = 'LITESTORE \u2014 ' + productName;

    if (productGame === 'robux') {
        document.getElementById('summary-icon').innerHTML = '<svg viewBox="0 0 24 24"><path d="M6 2l-4 4 4 4 4-4-4-4zm6.5 7C11.12 9 10 10.12 10 11.5s1.12 2.5 2.5 2.5 2.5-1.12 2.5-2.5S13.88 9 12.5 9zM17 14c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"/></svg>';
        document.getElementById('summary-icon').className = 'order-icon dark';
    }

    // ‚îÄ‚îÄ Helpers ‚îÄ‚îÄ
    function setPage(id) {
        document.querySelectorAll('.checkout-page').forEach(function(p) { p.classList.remove('active'); });
        document.getElementById(id).classList.add('active');
    }

    function setStep(n) {
        for (var i = 1; i <= 4; i++) {
            var el = document.getElementById('step' + i);
            if (!el) continue;
            el.classList.remove('active', 'done');
            if (i < n) el.classList.add('done');
            else if (i === n) el.classList.add('active');
        }
    }

    function showLTCStatus(type, msg) {
        var el = document.getElementById('ltc-verify-status');
        el.style.display = 'block';
        el.textContent = msg;
        var styles = {
            success: ['rgba(34,197,94,0.1)',  '1px solid rgba(34,197,94,0.25)',  '#22c55e'],
            error:   ['rgba(239,68,68,0.08)', '1px solid rgba(239,68,68,0.2)',   '#ef4444'],
            info:    ['rgba(255,255,255,0.05)','1px solid rgba(255,255,255,0.1)', '#888']
        };
        var s = styles[type] || styles.info;
        el.style.background = s[0]; el.style.border = s[1]; el.style.color = s[2];
    }

    // ‚îÄ‚îÄ Method select ‚îÄ‚îÄ
    window.selectMethod = function(m) {
        selectedMethod = m;
        document.getElementById('method-blik').classList.toggle('selected', m === 'blik');
        document.getElementById('method-ltc').classList.toggle('selected',  m === 'ltc');
        document.getElementById('error-msg').textContent = '';
    };

    // ‚îÄ‚îÄ Step 1 ‚Üí 2 ‚îÄ‚îÄ
    window.goToPayment = function() {
        if (!selectedMethod) {
            document.getElementById('error-msg').textContent = 'Wybierz metodƒô p≈Çatno≈õci.';
            return;
        }
        setPage(selectedMethod === 'blik' ? 'page-blik' : 'page-ltc');
        setStep(2);
        if (selectedMethod === 'ltc') fetchLTCRate();
    };

    // ‚îÄ‚îÄ Step 2 ‚Üí 3 (Gamepass) ‚îÄ‚îÄ
    window.goToGamepass = function() {
        var robuxPrice = productRobux || parseInt(productName.replace(/\D/g, '')) || 1000;
        document.getElementById('gamepass-price').textContent = robuxPrice + ' ROBUX';
        setPage('page-gamepass');
        setStep(3);
    };

    // ‚îÄ‚îÄ Step 3 ‚Üí 4 ‚îÄ‚îÄ
    window.goToRobloxForm = function() {
        var link = document.getElementById('gamepass-link').value.trim();
        var err  = document.getElementById('error-gamepass');
        if (!link) { err.textContent = 'Podaj link do Gamepassu.'; return; }
        if (!link.includes('roblox.com')) { err.textContent = 'Link musi prowadziƒá do roblox.com'; return; }
        err.textContent = '';
        setPage('page-roblox');
        setStep(4);
    };

    // ‚îÄ‚îÄ Back ‚îÄ‚îÄ
    window.goBack = function(toStep) {
        if (toStep === 1) { setPage('page-method');   setStep(1); }
        if (toStep === 2) { setPage(selectedMethod === 'blik' ? 'page-blik' : 'page-ltc'); setStep(2); }
        if (toStep === 3) { setPage('page-gamepass'); setStep(3); }
    };

    // ‚îÄ‚îÄ Copy LTC address ‚îÄ‚îÄ
    window.copyAddress = function() {
        navigator.clipboard.writeText(LTC_ADDRESS);
        var btn = document.querySelector('.copy-btn');
        btn.textContent = 'SKOPIOWANO!';
        btn.style.color = '#22c55e';
        setTimeout(function() { btn.textContent = 'KOPIUJ'; btn.style.color = ''; }, 2000);
    };


    // ‚îÄ‚îÄ Fetch LTC rate (przez Netlify Function ‚Äî brak problem√≥w z CORS) ‚îÄ‚îÄ
    function fetchLTCRate() {
        fetch('/api/ltc-rate')
            .then(function(r) { return r.json(); })
            .then(function(data) {
                if (!data.PLN) throw new Error('Brak danych');
                var ltcPln  = parseFloat(data.PLN);
                var pln     = parseFloat(productPrice.replace(' z≈Ç','').replace(',','.'));
                expectedLTC = pln / ltcPln;
                document.getElementById('ltc-amount-ltc').textContent         = expectedLTC.toFixed(6) + ' LTC';
                document.getElementById('ltc-amount-pln-display').textContent = productPrice;
            })
            .catch(function(e) {
                console.error('LTC rate error:', e);
                document.getElementById('ltc-amount-ltc').innerHTML =
                    '<span style="color:#ef4444;font-size:12px;cursor:pointer;" onclick="retryLTCRate()">‚ùå B≈ÇƒÖd kursu ‚Äî kliknij aby spr√≥bowaƒá ponownie</span>';
            });
    }

    window.retryLTCRate = function() {
        document.getElementById('ltc-amount-ltc').innerHTML = '<span style="color:#555;font-size:12px;">pobieranie kursu...</span>';
        fetchLTCRate();
    };

    // ‚îÄ‚îÄ Verify LTC on-chain ‚îÄ‚îÄ
    window.verifyLTC = function() {
        var btn = document.getElementById('ltc-verify-btn');
        if (!expectedLTC) { showLTCStatus('error', '‚è≥ Poczekaj ‚Äî pobieramy kurs LTC.'); return; }
        btn.textContent = 'SPRAWDZANIE...';
        btn.disabled = true;
        showLTCStatus('info', 'üîç Sprawdzamy blockchain Litecoin...');

        fetch('https://api.blockcypher.com/v1/ltc/main/addrs/' + LTC_ADDRESS + '/full?limit=10')
            .then(function(r) { return r.json(); })
            .then(function(data) {
                if (!data.txs || data.txs.length === 0) {
                    showLTCStatus('error', '‚ùå Nie wykryto transakcji. Upewnij siƒô ≈ºe wys≈Ça≈Çe≈õ LTC i spr√≥buj za chwilƒô.');
                    btn.textContent = 'WERYFIKUJ PONOWNIE'; btn.disabled = false; return;
                }
                var now       = Date.now();
                var limit     = 30 * 60 * 1000;
                var tolerance = 0.002;
                var match     = null;

                for (var i = 0; i < data.txs.length; i++) {
                    var tx  = data.txs[i];
                    var age = now - new Date(tx.received).getTime();
                    if (age > limit) continue;
                    for (var j = 0; j < tx.outputs.length; j++) {
                        var out = tx.outputs[j];
                        if (!out.addresses || out.addresses.indexOf(LTC_ADDRESS) === -1) continue;
                        var received = out.value / 1e8;
                        if (Math.abs(received - expectedLTC) <= tolerance) { match = tx; break; }
                    }
                    if (match) break;
                }

                if (!match) {
                    showLTCStatus('error', '‚ùå Nie wykryto p≈Çatno≈õci ' + expectedLTC.toFixed(6) + ' LTC w ciƒÖgu 30 min. Sprawd≈∫ kwotƒô i spr√≥buj ponownie.');
                    btn.textContent = 'WERYFIKUJ PONOWNIE'; btn.disabled = false;
                    return;
                }

                // Sprawd≈∫ czy ten tx hash by≈Ç ju≈º u≈ºyty
                var txHash = match.hash;
                window._checkTxHash(txHash).then(function(alreadyUsed) {
                    if (alreadyUsed) {
                        showLTCStatus('error', '‚ùå Ta transakcja zosta≈Ça ju≈º wykorzystana do innego zam√≥wienia.');
                        btn.textContent = 'WERYFIKUJ PONOWNIE'; btn.disabled = false;
                        return;
                    }
                    // Hash wolny ‚Äî oznacz jako u≈ºyty i przepu≈õƒá
                    window._markTxHash(txHash).then(function() {
                        verifiedTxHash = txHash;
                        showLTCStatus('success', '‚úÖ P≈Çatno≈õƒá zweryfikowana! Mo≈ºesz przej≈õƒá dalej.');
                        btn.textContent = 'ZWERYFIKOWANO ‚úì';
                        btn.style.background = '#22c55e'; btn.style.color = '#000';
                btn.onclick = window.goToGamepass;
                        btn.disabled = false;
                    });
                });
            })
            .catch(function() {
                showLTCStatus('error', '‚ö†Ô∏è B≈ÇƒÖd po≈ÇƒÖczenia z blockchain. Spr√≥buj za chwilƒô.');
                btn.textContent = 'WERYFIKUJ P≈ÅATNO≈öƒÜ'; btn.disabled = false;
            });
    };

    // ‚îÄ‚îÄ Submit order ‚îÄ‚îÄ
    window.submitOrder = function() {
        var gamepass  = document.getElementById('gamepass-link').value.trim();
        var nick      = document.getElementById('roblox-nick').value.trim();
        var email     = document.getElementById('contact-email').value.trim();
        var confirmed = document.getElementById('confirm-check').checked;
        var err       = document.getElementById('error-msg2');

        if (!nick)      { err.textContent = 'Podaj nick w Roblox.'; return; }
        if (!confirmed) { err.textContent = 'Potwierd≈∫ ≈ºe dokona≈Çe≈õ p≈Çatno≈õci.'; return; }

        err.textContent = '';
        var btn = document.querySelector('#page-roblox .btn-main');
        btn.textContent = 'WYSY≈ÅANIE...'; btn.disabled = true;

        window._submitOrderFirebase(productName, productType, productPrice, productGame, selectedMethod, gamepass, nick, email, verifiedTxHash)
            .then(function() {
                document.getElementById('success-method').textContent = selectedMethod === 'blik' ? 'BLIK' : 'Litecoin (LTC)';
                document.getElementById('success-nick').textContent   = nick;
                setPage('page-success'); setStep(5);
            })
            .catch(function() {
                err.textContent = 'B≈ÇƒÖd wysy≈Çania. Spr√≥buj ponownie.';
                btn.textContent = 'WY≈öLIJ ZAM√ìWIENIE'; btn.disabled = false;
            });
    };
</script>

</body>
</html>
